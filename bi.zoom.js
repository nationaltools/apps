!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self).mediumZoom=b()}(this,function(){function a(a){return"IMG"===a.tagName}function c(a){return a&&1===a.nodeType}function d(b){try{return Array.isArray(b)?b.filter(a):NodeList.prototype.isPrototypeOf(b)?[].slice.call(b).filter(a):c(b)?[b].filter(a):"string"==typeof b?[].slice.call(document.querySelectorAll(b)).filter(a):[]}catch(a){throw new TypeError("Zoom Image Error")}}function f(a,c){var d=b({bubbles:!1,cancelable:!1,detail:void 0},c);return"function"==typeof window.CustomEvent?new CustomEvent(a,d):((c=document.createEvent("CustomEvent")).initCustomEvent(a,d.bubbles,d.cancelable,d.detail),c)}var b=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c,d=arguments[b];for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a};return function(a,b){void 0===b&&(b={});var c,d=b.insertAt;"undefined"!=typeof document&&(c=document.head||document.getElementsByTagName("head")[0],(b=document.createElement("style")).type="text/css","top"===d&&c.firstChild?c.insertBefore(b,c.firstChild):c.appendChild(b),b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a)))}(".image_zooming_overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity;z-index:1000}.image_zooming__opened .image_zooming_overlay{cursor:pointer;cursor:zoom-out;opacity:1}.zoom_image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.zoom_image__hidden{visibility:hidden}.zoom_image__opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform;z-index:1001}"),function j(e,k){function o(){for(var b=arguments.length,c=Array(b),e=0;e<b;e++)c[e]=arguments[e];var f=c.reduce(function(a,b){return[].concat(a,d(b))},[]);return f.filter(function(b){return-1===a.indexOf(b)}).forEach(function(b){a.push(b),b.classList.add("zoom_image")}),r.forEach(function(a){var b=a.type,c=a.listener,d=a.options;f.forEach(function(a){a.addEventListener(b,c,d)})}),h}function n(){function d(){var f,g,h={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0};y.container&&(y.container instanceof Object?(f=(h=b({},h,y.container)).width-h.left-h.right-2*y.margin,g=h.height-h.top-h.bottom-2*y.margin):(k=(c(y.container)?y.container:document.querySelector(y.container)).getBoundingClientRect(),h=b({},h,{width:k.width,height:k.height,left:k.left,top:k.top}))),f=f||h.width-2*y.margin,g=g||h.height-2*y.margin;var j=A.zoomedHd||A.original,k=".svg"!==(j.currentSrc||j.src).substr(-4).toLowerCase()&&j.naturalWidth||f,l=".svg"!==(j.currentSrc||j.src).substr(-4).toLowerCase()&&j.naturalHeight||g,m=(j=j.getBoundingClientRect()).width,d=j.height;h="scale("+(k=Math.min(Math.min(k,f)/m,Math.min(l,g)/d))+") translate3d("+((f-m)/2-j.left+y.margin+h.left)/k+"px, "+((g-d)/2-j.top+y.margin+h.top)/k+"px, 0)",A.zoomed.style.transform=h,A.zoomedHd&&(A.zoomedHd.style.transform=h)}var g=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return new q(function(b){if(g&&-1===a.indexOf(g))b(h);else if(A.zoomed)b(h);else{if(g)A.original=g;else{if(!(0<a.length))return void b(h);A.original=a[0]}var i,j,k;A.original.dispatchEvent(f("image_zooming:open",{detail:{zoom:h}})),x=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,w=!0,A.zoomed=function(a){var b=(g=a.getBoundingClientRect()).top,c=g.left,f=g.width,g=g.height;a=a.cloneNode();var h=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,j=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return a.removeAttribute("id"),a.style.position="absolute",a.style.top=b+h+"px",a.style.left=c+j+"px",a.style.width=f+"px",a.style.height=g+"px",a.style.transform="",a}(A.original),document.body.appendChild(B),y.template&&(i=c(y.template)?y.template:document.querySelector(y.template),A.template=document.createElement("div"),A.template.appendChild(i.content.cloneNode(!0)),document.body.appendChild(A.template)),document.body.appendChild(A.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("image_zooming__opened")}),A.original.classList.add("zoom_image__hidden"),A.zoomed.classList.add("zoom_image__opened"),A.zoomed.addEventListener("click",v),A.zoomed.addEventListener("transitionend",function a(){w=!1,A.zoomed.removeEventListener("transitionend",a),A.original.dispatchEvent(f("image_zooming:opened",{detail:{zoom:h}})),b(h)}),A.original.getAttribute("data-zoom-src")?(A.zoomedHd=A.zoomed.cloneNode(),A.zoomedHd.removeAttribute("srcset"),A.zoomedHd.removeAttribute("sizes"),A.zoomedHd.src=A.zoomed.getAttribute("data-zoom-src"),A.zoomedHd.onerror=function(){clearInterval(j),console.warn("Unable to reach the zoom image target "+A.zoomedHd.src),A.zoomedHd=null,d()},j=setInterval(function(){A.zoomedHd.complete&&(clearInterval(j),A.zoomedHd.classList.add("zoom_image__opened"),A.zoomedHd.addEventListener("click",v),document.body.appendChild(A.zoomedHd),d())},10)):A.original.hasAttribute("srcset")?(A.zoomedHd=A.zoomed.cloneNode(),A.zoomedHd.removeAttribute("sizes"),A.zoomedHd.removeAttribute("loading"),k=A.zoomedHd.addEventListener("load",function(){A.zoomedHd.removeEventListener("load",k),A.zoomedHd.classList.add("zoom_image__opened"),A.zoomedHd.addEventListener("click",v),document.body.appendChild(A.zoomedHd),d()})):d()}})}function i(){var a=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).target;return A.original?v():n({target:a})}var q=window.Promise||function(a){function b(){}a(b,b)},v=function(){return new q(function(a){!w&&A.original?(w=!0,document.body.classList.remove("image_zooming__opened"),A.zoomed.style.transform="",A.zoomedHd&&(A.zoomedHd.style.transform=""),A.template&&(A.template.style.transition="opacity 150ms",A.template.style.opacity=0),A.original.dispatchEvent(f("image_zooming:close",{detail:{zoom:h}})),A.zoomed.addEventListener("transitionend",function b(){A.original.classList.remove("zoom_image__hidden"),document.body.removeChild(A.zoomed),A.zoomedHd&&document.body.removeChild(A.zoomedHd),document.body.removeChild(B),A.zoomed.classList.remove("zoom_image__opened"),A.template&&document.body.removeChild(A.template),w=!1,A.zoomed.removeEventListener("transitionend",b),A.original.dispatchEvent(f("image_zooming:closed",{detail:{zoom:h}})),A.original=null,A.zoomed=null,A.zoomedHd=null,A.template=null,a(h)})):a(h)})},a=[],r=[],w=!1,x=0,y=1<arguments.length&&void 0!==k?k:{},A={original:null,zoomed:null,zoomedHd:null,template:null};"[object Object]"===Object.prototype.toString.call(e)?y=e:!e&&"string"!=typeof e||o(e),y=b({margin:0,background:"var(--color-background)",scrollOffset:30,container:null,template:null},y);var g,t,B=(g=y.background,(t=document.createElement("div")).classList.add("image_zooming_overlay"),t.style.background=g,t);document.addEventListener("click",function(b){(b=b.target)===B?v():-1!==a.indexOf(b)&&i({target:b})}),document.addEventListener("keyup",function(a){"Escape"!==(a=a.key||a.keyCode)&&"Esc"!==a&&27!==a||v()}),document.addEventListener("scroll",function(){!w&&A.original&&Math.abs(x-(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0))>y.scrollOffset&&setTimeout(v,100)}),window.addEventListener("resize",v);var h={open:n,close:v,toggle:i,update:function(){var d,g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return g.background&&(B.style.background=g.background),g.container&&g.container instanceof Object&&(g.container=b({},y.container,g.container)),g.template&&(d=c(g.template)?g.template:document.querySelector(g.template),g.template=d),y=b({},y,g),a.forEach(function(a){a.dispatchEvent(f("image_zooming:update",{detail:{zoom:h}}))}),h},clone:function(){return j(b({},y,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}))},attach:o,detach:function(){for(var b=arguments.length,c=Array(b),e=0;e<b;e++)c[e]=arguments[e];A.zoomed&&v();var g=0<c.length?c.reduce(function(a,b){return[].concat(a,d(b))},[]):a;return g.forEach(function(a){a.classList.remove("zoom_image"),a.dispatchEvent(f("image_zooming:detach",{detail:{zoom:h}}))}),a=a.filter(function(a){return-1===g.indexOf(a)}),h},on:function(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return a.forEach(function(a){a.addEventListener("image_zooming:"+b,c,d)}),r.push({type:"image_zooming:"+b,listener:c,options:d}),h},off:function(b,c){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return a.forEach(function(a){a.removeEventListener("image_zooming:"+b,c,d)}),r=r.filter(function(a){return a.type!=="image_zooming:"+b||a.listener.toString()!==c.toString()}),h},getOptions:function(){return y},getImages:function(){return a},getZoomedImage:function(){return A.original}};return h}}),mediumZoom(document.querySelectorAll(".post-body img"));
